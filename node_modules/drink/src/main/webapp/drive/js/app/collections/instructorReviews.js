"use strict";
define( [
  '../../../../bower_components/underscore/underscore',
  'backbone',
	'models/instructorReview'
], function( _, Backbone, InstructorReviewModel ){

	var InstructorReviews = Backbone.Collection.extend({
		model : InstructorReviewModel,
		instructorId: null,
		initialize: function( ) {


		},
		url : function() {

			// need rpp to ensure we get 10 results for mobile
				return window.app.config.apiURL + "/instructors/" + this.instructorId + '/reviews' + this.queryString + ( this.queryString ? "&rpp=10" : "?rpp=10" );

		},

		setInstructor: function ( instructorId ) {

			this.instructorId = instructorId;

		},

		parse: function( response ) {
			var self = this;
			if ( response.pages.next ) {
				var sub = response.pages.next.split( '?' );
				if( sub.length > 0 ){
					this.queryString = '?' + sub[1];
				}
			}

			if ( response.reviews ) {

				_.each( response.reviews, function( r ) {
					r.instructorId = self.instructorId - 0;
				} );

				return response.reviews;
			}
		},
		queryString: ''

	});

	return InstructorReviews;
} );
