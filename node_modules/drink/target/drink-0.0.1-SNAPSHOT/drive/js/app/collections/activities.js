"use strict";
define( [
  '../../../../bower_components/underscore/underscore',
  'backbone',
	'models/activity',
	'config'
], function( _, Backbone, ActivityModel, Config ){

	var Activities = Backbone.Collection.extend({
		model : ActivityModel,
		learnerId: null,
		token: null,
		totalMonths:0,
		url : function() {

			return Config.apiURL + "/learners/" + this.learnerId + '/journey' + this.queryString;
		},
		parse: function( response ) {

			if ( window.activitiesDb ) {
				window.activitiesDb.addCollection( response );
			}

			if ( response.pages.next ) {
				var sub = response.pages.next.split("?");

				if(sub.length > 0){

					this.queryString = '?' + sub[1];
				}
			}

			if ( response.stats ) {
				this.totalMonths = response.stats.totalMonths;
			}

			if ( response.activities ) {
				return response.activities;
			}
		},
		queryString: ''

	});

	return Activities;
} );
