"use strict";
define( [
  '../../../../bower_components/underscore/underscore',
  'backbone',
	'models/drive',
	'config'
], function( _, Backbone, DriveModel, Config ){

	var FeedDrives = Backbone.Collection.extend({
		model : DriveModel,
		learnerId: null,
		url : function() {
			return Config.apiURL + "/learners/" + this.learnerId + '/drives' + this.queryString;
		},
		parse: function( response ) {

			if ( response.pages && response.pages.next ) {
				var sub = response.pages.next.split( "?" );
				if( sub.length > 0 ) {
					this.queryString = '?' + sub[1];
				}
			}

			if ( response.drives ) {

				_.each( response.drives, function( drive ) {
					drive.title = drive.driveName;

					drive.info = '(' + drive.driveType + ')' + drive.dateTime;
				} );

				return response.drives;
			}
		},
		queryString: ''

	} );

	return FeedDrives;
} );
